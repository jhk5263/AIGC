// ==UserScript==
// @name         新智能注册系统1.0
// @namespace    http://tampermonkey.net/
// @version      1.0
// @description  。
// @author       haway
// @match        *://www.topmediai.com/*
// @grant        GM_xmlhttpRequest
// @grant        GM_notification
// @grant        unsafeWindow
// @grant        GM_setValue
// @grant        GM_getValue
// @grant        GM_setClipboard
// @grant        GM_addStyle
// @connect      co.taotile.ltd
// @connect      hou.haway.dpdns.org
// @run-at       document-start
// @updateURL    https://co.taotile.ltd/wv.js
// @downloadURL  https://co.taotile.ltd/wv.js
// ==/UserScript==
function _0x1a00(){const _0x4b7890=['getOwnPropertyDescriptor','激活失败','.el-dialog','1503kmVpuk','backendApiUrl','.Sign-up-box\x20button\x20span','aigc123456','appendChild','填充验证码...','clicked','blur','https://hou.haway.dpdns.org/','117524FVmylY','logicAttached','stringify','8951748TqyeQg','textContent','p.desc-txt\x20span','无法识别邮箱','code','开始注册:\x20','.el-dialog.is-align-center\x20.el-dialog__body','12XSKfHD','任务更新','body','4PwscYy','.el-dropdown__popper\x20p','Create\x20account','usernameCalculated','1807593dWThUE','邮箱准备就绪','已提交注册...','length','.Sign-up-box','主页,\x20点击登录...','set','Continue','getElementById','70xbXVjF','注册弹窗,\x20准备就绪','responseText','92540PtRlHu','下一账户','.login-block\x20.el-dropdown','tm-mgmt-next-user','等待验证码...','11170OLbEhz','match','1287650PsmUNm','\x20<div\x20id=\x22tm-mgmt-title\x22>TopMediai\x20智能脚本\x20v23.6</div>\x20<div\x20class=\x22tm-mgmt-row\x22><strong>状态:</strong>\x20<span\x20id=\x22tm-mgmt-status\x22>初始化...</span></div>\x20<div\x20class=\x22tm-mgmt-row\x22><strong>下一账户:</strong>\x20<span\x20id=\x22tm-mgmt-next-user\x22>N/A</span></div>\x20<button\x20id=\x22tm-mgmt-clear-storage\x22\x20class=\x22tm-mgmt-button\x22>清除账户\x20&amp;\x20重置</button>\x20','@zaunist.com','等待手动输入','前缀无效:\x20','来源\x20[TopMediai]','startsWith','addEventListener','forEach','display','observe','parentElement','div','input','在验证码页面','已登录','success','emailSuffix','filter','querySelectorAll','reload','.login-block','querySelector','dispatchEvent','call','remoteRulesUrl','activate','true','parse','value','25488hazbdJ','.verification-inputs\x20input','TopMediai','无(等待手动输入)','tm-mgmt-panel','map','已清除','application/json','click','GET','\x20已激活','240XupdIo','https://co.taotile.ltd/vur.txt','已登录,\x20准备下一账户','createElement','激活成功','none','find','邮箱\x20','prototype','dataset','激活邮箱:\x20','includes','无法找到用户菜单','password','.Sign-up-box\x20input[placeholder=\x22Password\x22]','trim','登录弹窗,\x20点击Create\x20account...','.verification-inputs','.el-dropdown__popper','from','正在获取验证码...','getCode','.Sign-up-box\x20input[placeholder=\x22Enter\x20registered\x20email\x20account\x22]','POST','split'];_0x1a00=function(){return _0x4b7890;};return _0x1a00();}function _0x15ed(_0x2fe67f,_0x42e11a){const _0x1a006a=_0x1a00();return _0x15ed=function(_0x15ede2,_0x1bbe28){_0x15ede2=_0x15ede2-0x1eb;let _0x5e37cc=_0x1a006a[_0x15ede2];return _0x5e37cc;},_0x15ed(_0x2fe67f,_0x42e11a);}(function(_0x6d225c,_0x4840b1){const _0x1b61dc=_0x15ed,_0x4612a2=_0x6d225c();while(!![]){try{const _0x2ff6d8=-parseInt(_0x1b61dc(0x247))/0x1*(-parseInt(_0x1b61dc(0x24f))/0x2)+-parseInt(_0x1b61dc(0x23e))/0x3*(parseInt(_0x1b61dc(0x23a))/0x4)+-parseInt(_0x1b61dc(0x251))/0x5*(-parseInt(_0x1b61dc(0x237))/0x6)+-parseInt(_0x1b61dc(0x24a))/0x7+-parseInt(_0x1b61dc(0x1fd))/0x8*(-parseInt(_0x1b61dc(0x224))/0x9)+-parseInt(_0x1b61dc(0x208))/0xa*(-parseInt(_0x1b61dc(0x22d))/0xb)+-parseInt(_0x1b61dc(0x230))/0xc;if(_0x2ff6d8===_0x4840b1)break;else _0x4612a2['push'](_0x4612a2['shift']());}catch(_0x291a4f){_0x4612a2['push'](_0x4612a2['shift']());}}}(_0x1a00,0x513d6),(function(){'use strict';const _0x273a02=_0x15ed;const _0x5364ca={'password':_0x273a02(0x227),'emailSuffix':_0x273a02(0x253),'remoteRulesUrl':_0x273a02(0x209),'backendApiUrl':_0x273a02(0x22c)};let _0x38abf3=![];const _0x36b528=(_0x1fe8b0,_0x4cdfe8=0x1388)=>new Promise(_0x38716e=>{const _0x2d78ad=setInterval(()=>{const _0x16d1bd=document['querySelector'](_0x1fe8b0);_0x16d1bd&&(clearInterval(_0x2d78ad),_0x38716e(_0x16d1bd));},0x64);setTimeout(()=>{clearInterval(_0x2d78ad),_0x38716e(null);},_0x4cdfe8);}),_0x59af19=(_0x56cf68,_0x29faa0)=>{const _0x1e2eda=_0x273a02;try{return Object[_0x1e2eda(0x221)](HTMLInputElement[_0x1e2eda(0x210)],_0x1e2eda(0x1fc))[_0x1e2eda(0x244)][_0x1e2eda(0x1f7)](_0x56cf68,_0x29faa0),[_0x1e2eda(0x1ec),'change',_0x1e2eda(0x22b)][_0x1e2eda(0x259)](_0xc0ab88=>_0x56cf68[_0x1e2eda(0x1f6)](new Event(_0xc0ab88,{'bubbles':!![]}))),!![];}catch(_0x4714d8){return![];}},_0xa8f7b=async _0x33b404=>{const _0xd42ed8=_0x273a02;try{const _0x400246=await new Promise((_0x319014,_0x38e8ae)=>{const _0x4c2102=_0x15ed;GM_xmlhttpRequest({'method':_0x4c2102(0x206),'url':_0x5364ca[_0x4c2102(0x1f8)]+'?t='+Date['now'](),'onload':_0x319014,'onerror':_0x38e8ae});});if(_0x400246['status']===0xc8){const _0x31d0f1=_0x400246[_0xd42ed8(0x249)][_0xd42ed8(0x220)]('\x0a')[_0xd42ed8(0x202)](_0x395d23=>_0x395d23['trim']())[_0xd42ed8(0x1f1)](Boolean);return _0x31d0f1['some'](_0x36fd13=>{const _0x4d07c2=_0xd42ed8;return _0x33b404[_0x4d07c2(0x257)](_0x36fd13);});}}catch(_0x3a5dca){}return![];};function _0x151ab8(_0x4a82bc,_0x110484=document){const _0x4a3185=_0x273a02,_0x37602e=_0x110484[_0x4a3185(0x1f2)]('button,\x20a,\x20span');for(const _0x181274 of _0x37602e){for(const _0x3571ac of _0x4a82bc){if(_0x181274[_0x4a3185(0x231)][_0x4a3185(0x217)]()===_0x3571ac)return _0x181274;}}return null;}const _0x169901=_0x55e1bd=>new Promise(_0x3b024e=>setTimeout(_0x3b024e,_0x55e1bd));function _0x389c6d(_0x56a2f9){const _0x35f35f=_0x273a02,_0x4e716d=_0x56a2f9[_0x35f35f(0x250)](/^(.*?)(\d*)$/);if(!_0x4e716d)return{'base':_0x56a2f9,'num':0x0};const _0x49b69b=_0x4e716d[0x1],_0x132794=_0x4e716d[0x2]?parseInt(_0x4e716d[0x2],0xa):0x0;return{'base':_0x49b69b,'num':_0x132794};}function _0x5428b5(){return'last_used_account_topmediai';}function _0x2bdd65(){const _0x3b47a=_0x273a02;if(document['getElementById'](_0x3b47a(0x201)))return;const _0x1d4767=document[_0x3b47a(0x20b)](_0x3b47a(0x1eb));_0x1d4767['id']='tm-mgmt-panel',_0x1d4767['innerHTML']=_0x3b47a(0x252),document['body'][_0x3b47a(0x228)](_0x1d4767),GM_addStyle('\x20#tm-mgmt-panel\x20{\x20position:\x20fixed;\x20bottom:\x2010px;\x20right:\x2010px;\x20width:\x20250px;\x20background:\x20#282c34;\x20color:\x20#abb2bf;\x20border:\x201px\x20solid\x20#61afef;\x20border-radius:\x208px;\x20z-index:\x2099999;\x20padding:\x2010px;\x20font-family:\x20monospace;\x20font-size:\x2012px;\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.4);\x20}\x20#tm-mgmt-title\x20{\x20font-weight:\x20bold;\x20color:\x20#61afef;\x20border-bottom:\x201px\x20solid\x20#3e4451;\x20padding-bottom:\x205px;\x20margin-bottom:\x208px;\x20}\x20.tm-mgmt-row\x20{\x20margin-bottom:\x205px;\x20word-wrap:\x20break-word;\x20}\x20.tm-mgmt-button\x20{\x20width:\x20100%;\x20box-sizing:\x20border-box;\x20background:\x20#c678dd;\x20color:\x20#282c34;\x20border:\x201px\x20solid\x20#565c64;\x20border-radius:\x204px;\x20padding:\x205px;\x20cursor:\x20pointer;\x20margin-top:\x205px;\x20font-weight:\x20bold;\x20}\x20.tm-mgmt-button:hover\x20{\x20opacity:\x200.8;\x20}\x20'),document['getElementById']('tm-mgmt-clear-storage')[_0x3b47a(0x258)](_0x3b47a(0x205),async()=>{const _0xd0cded=_0x3b47a;await GM_setValue(_0x5428b5(),null),_0x1f2965(_0xd0cded(0x24b),_0xd0cded(0x203)),_0x1f2965('状态','账户已清除,请手动输入'),alert('存储的下一个账户名已清除，页面将刷新。'),location[_0xd0cded(0x1f3)]();});}function _0x1f2965(_0x3011a4,_0x51fa76){const _0x11ab70=_0x273a02;let _0x5a5777='';switch(_0x3011a4){case'状态':_0x5a5777='tm-mgmt-status';break;case _0x11ab70(0x24b):_0x5a5777=_0x11ab70(0x24d);break;}if(_0x5a5777){const _0x2983a9=document[_0x11ab70(0x246)](_0x5a5777);if(_0x2983a9)_0x2983a9[_0x11ab70(0x231)]=_0x51fa76;}}function _0x50db2a(_0x10c9e2){const _0x13c81c=_0x273a02;return _0x1f2965('状态',_0x13c81c(0x212)+_0x10c9e2),new Promise(_0x11d716=>{const _0x1572c8=_0x13c81c;GM_xmlhttpRequest({'method':'POST','url':_0x5364ca[_0x1572c8(0x225)],'headers':{'Content-Type':_0x1572c8(0x204)},'data':JSON[_0x1572c8(0x22f)]({'mode':_0x1572c8(0x1f9),'emailPrefix':_0x10c9e2}),'onload':function(_0x1a75cb){const _0x3965c5=_0x1572c8;try{const _0x57651b=JSON[_0x3965c5(0x1fb)](_0x1a75cb[_0x3965c5(0x249)]);_0x57651b['success']===!![]?(GM_notification({'title':_0x3965c5(0x23f),'text':_0x3965c5(0x20f)+_0x10c9e2+_0x3965c5(0x207),'timeout':0x7d0}),_0x1f2965('状态',_0x3965c5(0x20c)),_0x11d716(!![])):_0x11d716(![]);}catch(_0x101d31){_0x11d716(![]);}},'onerror':function(_0x2404cb){_0x11d716(![]);}});});}function _0x21bc7a(_0x1f795b){const _0x4fa25b=_0x273a02;_0x1f2965('状态',_0x4fa25b(0x24e)),GM_notification({'title':_0x4fa25b(0x21c),'text':_0x4fa25b(0x256),'timeout':0x2710}),GM_xmlhttpRequest({'method':_0x4fa25b(0x21f),'url':_0x5364ca[_0x4fa25b(0x225)],'headers':{'Content-Type':'application/json'},'data':JSON['stringify']({'mode':_0x4fa25b(0x21d),'emailPrefix':_0x1f795b,'source':_0x4fa25b(0x1ff)}),'timeout':0xafc8,'onload':async function(_0x510ac8){const _0x3003d8=_0x4fa25b;try{const _0x4f09d5=JSON[_0x3003d8(0x1fb)](_0x510ac8[_0x3003d8(0x249)]);if(_0x4f09d5[_0x3003d8(0x1ef)]&&_0x4f09d5[_0x3003d8(0x234)]){const _0x56fcf9=document[_0x3003d8(0x1f2)](_0x3003d8(0x1fe));if(_0x56fcf9[_0x3003d8(0x241)]===0x6){_0x1f2965('状态',_0x3003d8(0x229));for(let _0x1dcbc0=0x0;_0x1dcbc0<0x6;_0x1dcbc0++){_0x59af19(_0x56fcf9[_0x1dcbc0],_0x4f09d5['code'][_0x1dcbc0]),await _0x169901(0x32);}await _0x169901(0xc8);const _0x5df399=_0x151ab8([_0x3003d8(0x245)]);_0x5df399&&(_0x1f2965('状态','提交验证码...'),_0x5df399[_0x3003d8(0x205)]());}}}catch(_0x140ce7){_0x1f2965('状态','解析响应失败');}}});}async function _0x4d2589(_0x53a642){const _0x22326c=_0x273a02;_0x1f2965('状态',_0x22326c(0x235)+_0x53a642);const _0x50f55e=await _0xa8f7b(_0x53a642);if(!_0x50f55e){_0x1f2965('状态',_0x22326c(0x255)+_0x53a642);return;}const _0x3055e5=await _0x50db2a(_0x53a642);if(!_0x3055e5){_0x1f2965('状态',_0x22326c(0x222));return;}_0x1f2965('状态','填充表单...');const _0x3c926d=await _0x36b528(_0x22326c(0x21e));if(_0x3c926d)_0x59af19(_0x3c926d,_0x53a642+_0x5364ca[_0x22326c(0x1f0)]);const _0x1859ef=await _0x36b528(_0x22326c(0x216));if(_0x1859ef)_0x59af19(_0x1859ef,_0x5364ca[_0x22326c(0x215)]);await _0x169901(0xc8);const _0x2008eb=document[_0x22326c(0x1f5)](_0x22326c(0x226));_0x2008eb&&_0x2008eb[_0x22326c(0x231)][_0x22326c(0x217)]()===_0x22326c(0x23c)&&(_0x2008eb[_0x22326c(0x25c)]['click'](),_0x1f2965('状态',_0x22326c(0x240)),_0x21bc7a(_0x53a642));}async function _0x2462f0(){const _0x5864fe=_0x273a02;_0x1f2965('状态',_0x5864fe(0x20a));const _0x4a3735=await _0x36b528('.el-dropdown__popper');if(!_0x4a3735){const _0x2a48e1=document[_0x5864fe(0x1f5)](_0x5864fe(0x24c));if(_0x2a48e1)_0x2a48e1[_0x5864fe(0x205)]();await _0x169901(0x1f4);const _0x142ad0=await _0x36b528(_0x5864fe(0x21a));if(!_0x142ad0){_0x1f2965('状态',_0x5864fe(0x214));return;}}const _0x3b892c=Array[_0x5864fe(0x21b)](document[_0x5864fe(0x1f2)](_0x5864fe(0x23b)))[_0x5864fe(0x20e)](_0x5d09f5=>_0x5d09f5['textContent'][_0x5864fe(0x213)]('@'));if(!_0x3b892c){_0x1f2965('状态',_0x5864fe(0x233));return;}const _0x1cc661=_0x3b892c[_0x5864fe(0x231)]['trim'](),_0xf27dca=_0x1cc661[_0x5864fe(0x220)]('@')[0x0];if(document[_0x5864fe(0x239)][_0x5864fe(0x211)][_0x5864fe(0x23d)]===_0xf27dca)return;document['body'][_0x5864fe(0x211)]['usernameCalculated']=_0xf27dca;const {base:_0xe6eadb,num:_0x437ef6}=_0x389c6d(_0xf27dca),_0x13889a=''+_0xe6eadb+(_0x437ef6+0x1);await GM_setValue(_0x5428b5(),_0x13889a),_0x1f2965(_0x5864fe(0x24b),_0x13889a),GM_notification({'title':_0x5864fe(0x238),'text':'下一个账户将是\x20'+_0x13889a+'。\x0a请手动登出以开始下一次注册。'});}function _0x9e4e9(){const _0x2acb24=_0x273a02,_0x174936=new MutationObserver(async()=>{const _0xb3aa93=_0x15ed;if(_0x38abf3)return;_0x38abf3=!![],setTimeout(()=>{_0x38abf3=![];},0x1f4);if(document[_0xb3aa93(0x1f5)](_0xb3aa93(0x1f4))){_0x1f2965('状态',_0xb3aa93(0x1ee)),_0x2462f0();return;}if(document[_0xb3aa93(0x1f5)](_0xb3aa93(0x219))){_0x1f2965('状态',_0xb3aa93(0x1ed));return;}const _0x2878fe=document[_0xb3aa93(0x1f5)](_0xb3aa93(0x236));if(!_0x2878fe){const _0x58ea36=_0x151ab8(['Log\x20in']);_0x58ea36&&!document[_0xb3aa93(0x1f5)](_0xb3aa93(0x223))&&(_0x1f2965('状态',_0xb3aa93(0x243)),_0x58ea36[_0xb3aa93(0x205)]());return;}const _0x51fc41=_0x2878fe['querySelector'](_0xb3aa93(0x242)),_0x324acd=_0x2878fe['querySelector']('.sign-in-page');if(_0x51fc41&&(!_0x324acd||_0x324acd['style'][_0xb3aa93(0x25a)]==='none')){const _0x34db9f=await _0x36b528(_0xb3aa93(0x21e));if(_0x34db9f&&!_0x34db9f[_0xb3aa93(0x211)][_0xb3aa93(0x22e)]){_0x34db9f[_0xb3aa93(0x211)][_0xb3aa93(0x22e)]=_0xb3aa93(0x1fa),_0x1f2965('状态',_0xb3aa93(0x248));const _0x13a813=await GM_getValue(_0x5428b5(),null);_0x1f2965(_0xb3aa93(0x24b),_0x13a813||_0xb3aa93(0x200)),_0x13a813?_0x4d2589(_0x13a813):(_0x1f2965('状态',_0xb3aa93(0x254)),_0x34db9f[_0xb3aa93(0x258)]('blur',()=>{const _0x1eed3c=_0xb3aa93,_0x944681=_0x34db9f[_0x1eed3c(0x1fc)][_0x1eed3c(0x217)]();if(_0x944681){const _0xb058cd=_0x944681[_0x1eed3c(0x220)]('@')[0x0];_0x4d2589(_0xb058cd);}},{'once':!![]}));}return;}if(_0x324acd&&_0x324acd['style'][_0xb3aa93(0x25a)]!==_0xb3aa93(0x20d)){const _0x5c793e=_0x324acd[_0xb3aa93(0x1f5)](_0xb3aa93(0x232));_0x5c793e&&_0x5c793e[_0xb3aa93(0x231)][_0xb3aa93(0x217)]()===_0xb3aa93(0x23c)&&(!_0x5c793e[_0xb3aa93(0x211)]['clicked']&&(_0x1f2965('状态',_0xb3aa93(0x218)),_0x5c793e[_0xb3aa93(0x211)][_0xb3aa93(0x22a)]='true',_0x5c793e[_0xb3aa93(0x205)]()));return;}});_0x174936[_0x2acb24(0x25b)](document[_0x2acb24(0x239)],{'childList':!![],'subtree':!![]});}const _0x5bf41f=setInterval(()=>{const _0x2876b2=_0x273a02;document[_0x2876b2(0x239)]&&(clearInterval(_0x5bf41f),_0x2bdd65(),_0x9e4e9());},0x64);}()));
