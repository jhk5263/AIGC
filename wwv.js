// ==UserScript==
// @name         新智能注册系统1.0
// @namespace    http://tampermonkey.net/
// @version      1.1
// @description  。
// @author       haway
// @match        *://www.topmediai.com/*
// @grant        GM_xmlhttpRequest
// @grant        GM_notification
// @grant        unsafeWindow
// @grant        GM_setValue
// @grant        GM_getValue
// @grant        GM_setClipboard
// @grant        GM_addStyle
// @connect      co.taotile.ltd
// @connect      hou.haway.dpdns.org
// @run-at       document-start
// @updateURL    https://co.taotile.ltd/wwv.js
// @downloadURL  https://co.taotile.ltd/wwv.js
// ==/UserScript==
function _0x30a0(_0x26e55c,_0x41cc24){const _0x2f4763=_0x2f47();return _0x30a0=function(_0x30a0dc,_0x360e4d){_0x30a0dc=_0x30a0dc-0x1d3;let _0x2e1c4d=_0x2f4763[_0x30a0dc];return _0x2e1c4d;},_0x30a0(_0x26e55c,_0x41cc24);}function _0x2f47(){const _0xb7c275=['getElementById','aigc123456','some','.Sign-up-box\x20input[placeholder=\x22Enter\x20registered\x20email\x20account\x22]','startsWith','.Sign-up-box\x20button\x20span','true','backendApiUrl','已登录','getOwnPropertyDescriptor','change','length','.el-dropdown__popper\x20p','无法识别邮箱','split','forEach','.el-dialog','p.desc-txt\x20span','waitingForManual','now','logicAttached','激活失败','match','click','激活成功','set','display','存储的下一个账户名已清除，页面将刷新。','addEventListener','map','getCode','已登录,\x20准备下一账户','parentElement','准备获取验证码...','1699410qisWnG','等待手动输入','call','button,\x20a,\x20span','tm-mgmt-panel','641209qcERTx','.el-dropdown__popper','remoteRulesUrl','Create\x20account','\x20<div\x20id=\x22tm-mgmt-title\x22>TopMediai\x20智能脚本\x20v23.9</div>\x20<div\x20class=\x22tm-mgmt-row\x22><strong>状态:</strong>\x20<span\x20id=\x22tm-mgmt-status\x22>初始化...</span></div>\x20<div\x20class=\x22tm-mgmt-row\x22><strong>下一账户:</strong>\x20<span\x20id=\x22tm-mgmt-next-user\x22>N/A</span></div>\x20<button\x20id=\x22tm-mgmt-clear-storage\x22\x20class=\x22tm-mgmt-button\x22>清除账户\x20&amp;\x20重置</button>\x20','observe','value','emailSuffix','Continue','7bbVzIp','2737768hJJNlm','style','false','5lCGOAa','注册弹窗,\x20准备就绪','1097250pZvJLm','.Sign-up-box','.el-dialog.is-align-center\x20.el-dialog__body','body','7821522DHvzms','code','tm-mgmt-next-user','https://hou.haway.dpdns.org/','POST','@zaunist.com','\x20#tm-mgmt-panel\x20{\x20position:\x20fixed;\x20bottom:\x2010px;\x20right:\x2010px;\x20width:\x20250px;\x20background:\x20#282c34;\x20color:\x20#abb2bf;\x20border:\x201px\x20solid\x20#61afef;\x20border-radius:\x208px;\x20z-index:\x2099999;\x20padding:\x2010px;\x20font-family:\x20monospace;\x20font-size:\x2012px;\x20box-shadow:\x200\x204px\x2012px\x20rgba(0,0,0,0.4);\x20}\x20#tm-mgmt-title\x20{\x20font-weight:\x20bold;\x20color:\x20#61afef;\x20border-bottom:\x201px\x20solid\x20#3e4451;\x20padding-bottom:\x205px;\x20margin-bottom:\x208px;\x20}\x20.tm-mgmt-row\x20{\x20margin-bottom:\x205px;\x20word-wrap:\x20break-word;\x20}\x20.tm-mgmt-button\x20{\x20width:\x20100%;\x20box-sizing:\x20border-box;\x20background:\x20#c678dd;\x20color:\x20#282c34;\x20border:\x201px\x20solid\x20#565c64;\x20border-radius:\x204px;\x20padding:\x205px;\x20cursor:\x20pointer;\x20margin-top:\x205px;\x20font-weight:\x20bold;\x20}\x20.tm-mgmt-button:hover\x20{\x20opacity:\x200.8;\x20}\x20','none','from','trim','querySelectorAll','appendChild','轮询验证码...(','下一个账户将是\x20','.sign-in-page','账户已清除,请手动输入','登录弹窗,\x20点击Create\x20account...','秒内未能获取到验证码。','已清除','Log\x20in','querySelector','stringify','。\x0a请手动登出以开始下一次注册。','responseText','dataset','input','includes','blur','clicked','任务更新','usernameCalculated','password','.verification-inputs','主页,\x20点击登录...','.verification-inputs\x20input','success','激活邮箱:\x20','createElement','last_used_account_topmediai','tm-mgmt-clear-storage','783198FcbYHf','.login-block','textContent','round','div','下一账户','开始注册:\x20','application/json','TopMediai','前缀无效:\x20','parse','操作失败','activate','2275748GckYid'];_0x2f47=function(){return _0xb7c275;};return _0x2f47();}(function(_0x4ea032,_0x229fd7){const _0x145d07=_0x30a0,_0x3cc91b=_0x4ea032();while(!![]){try{const _0x5b5a41=-parseInt(_0x145d07(0x206))/0x1+parseInt(_0x145d07(0x241))/0x2+parseInt(_0x145d07(0x215))/0x3+parseInt(_0x145d07(0x1de))/0x4*(-parseInt(_0x145d07(0x213))/0x5)+parseInt(_0x145d07(0x201))/0x6+-parseInt(_0x145d07(0x20f))/0x7*(parseInt(_0x145d07(0x210))/0x8)+parseInt(_0x145d07(0x219))/0x9;if(_0x5b5a41===_0x229fd7)break;else _0x3cc91b['push'](_0x3cc91b['shift']());}catch(_0x15eb10){_0x3cc91b['push'](_0x3cc91b['shift']());}}}(_0x2f47,0x5739b),(function(){'use strict';const _0x43cfa1=_0x30a0;const _0x35d78a={'password':_0x43cfa1(0x1e0),'emailSuffix':_0x43cfa1(0x21e),'remoteRulesUrl':'https://co.taotile.ltd/vur.txt','backendApiUrl':_0x43cfa1(0x21c)};let _0x2c5281=![],_0x5be755=null;const _0x29f9cc=(_0x1585e1,_0xde86d9=0x1388)=>new Promise(_0x47c6fb=>{const _0x3cf702=setInterval(()=>{const _0x52c5ce=document['querySelector'](_0x1585e1);_0x52c5ce&&(clearInterval(_0x3cf702),_0x47c6fb(_0x52c5ce));},0x64);setTimeout(()=>{clearInterval(_0x3cf702),_0x47c6fb(null);},_0xde86d9);}),_0x1067c9=(_0x3056ed,_0xb753db)=>{const _0x53e4ea=_0x43cfa1;try{return Object[_0x53e4ea(0x1e8)](HTMLInputElement['prototype'],_0x53e4ea(0x20c))[_0x53e4ea(0x1f8)][_0x53e4ea(0x203)](_0x3056ed,_0xb753db),[_0x53e4ea(0x232),_0x53e4ea(0x1e9),_0x53e4ea(0x234)][_0x53e4ea(0x1ee)](_0x231122=>_0x3056ed['dispatchEvent'](new Event(_0x231122,{'bubbles':!![]}))),!![];}catch(_0x36cc5b){return![];}},_0x1b2550=async _0x1514ec=>{const _0x59f386=_0x43cfa1;try{const _0x1a81ea=await new Promise((_0x1f365e,_0xb16357)=>{const _0x2be401=_0x30a0;GM_xmlhttpRequest({'method':'GET','url':_0x35d78a[_0x2be401(0x208)]+'?t='+Date['now'](),'onload':_0x1f365e,'onerror':_0xb16357});});if(_0x1a81ea['status']===0xc8){const _0x2b9517=_0x1a81ea[_0x59f386(0x230)][_0x59f386(0x1ed)]('\x0a')[_0x59f386(0x1fc)](_0x44657b=>_0x44657b['trim']())['filter'](Boolean);return _0x2b9517[_0x59f386(0x1e1)](_0x209e48=>{const _0x13dc46=_0x59f386;return _0x1514ec[_0x13dc46(0x1e3)](_0x209e48);});}}catch(_0x4e8a01){}return![];};function _0x33cae5(_0x27b435,_0x3c02ec=document){const _0x4cc014=_0x43cfa1,_0x4c2444=_0x3c02ec[_0x4cc014(0x223)](_0x4cc014(0x204));for(const _0x1c1b30 of _0x4c2444){for(const _0x4d0203 of _0x27b435){if(_0x1c1b30[_0x4cc014(0x1d3)][_0x4cc014(0x222)]()===_0x4d0203)return _0x1c1b30;}}return null;}const _0x1f268f=_0x4a6c90=>new Promise(_0x319e6f=>setTimeout(_0x319e6f,_0x4a6c90));function _0x49b077(_0x40f3d0){const _0x16bd4a=_0x43cfa1,_0x5a9b72=_0x40f3d0[_0x16bd4a(0x1f5)](/^(.*?)(\d*)$/);if(!_0x5a9b72)return{'base':_0x40f3d0,'num':0x0};const _0x48e8f4=_0x5a9b72[0x1],_0x42dd72=_0x5a9b72[0x2]?parseInt(_0x5a9b72[0x2],0xa):0x0;return{'base':_0x48e8f4,'num':_0x42dd72};}function _0x567b07(){const _0x53c8d5=_0x43cfa1;return _0x53c8d5(0x23f);}function _0x590c72(){const _0x4d852f=_0x43cfa1;if(document[_0x4d852f(0x1df)](_0x4d852f(0x205)))return;const _0x386171=document[_0x4d852f(0x23e)](_0x4d852f(0x1d5));_0x386171['id']=_0x4d852f(0x205),_0x386171['innerHTML']=_0x4d852f(0x20a),document[_0x4d852f(0x218)][_0x4d852f(0x224)](_0x386171),GM_addStyle(_0x4d852f(0x21f)),document[_0x4d852f(0x1df)](_0x4d852f(0x240))[_0x4d852f(0x1fb)](_0x4d852f(0x1f6),async()=>{const _0x2a83e1=_0x4d852f;await GM_setValue(_0x567b07(),null),_0x25613f(_0x2a83e1(0x1d6),_0x2a83e1(0x22b)),_0x25613f('状态',_0x2a83e1(0x228)),alert(_0x2a83e1(0x1fa)),location['reload']();});}function _0x25613f(_0x4d16ba,_0x28cbaf){const _0x24160a=_0x43cfa1;let _0x147b41='';switch(_0x4d16ba){case'状态':_0x147b41='tm-mgmt-status';break;case'下一账户':_0x147b41=_0x24160a(0x21b);break;}if(_0x147b41){const _0x3d91f6=document[_0x24160a(0x1df)](_0x147b41);if(_0x3d91f6)_0x3d91f6[_0x24160a(0x1d3)]=_0x28cbaf;}}function _0x92bf65(_0x1c9869){const _0x2b66ab=_0x43cfa1;return _0x25613f('状态',_0x2b66ab(0x23d)+_0x1c9869),new Promise(_0x455daa=>{const _0x1a21b2=_0x2b66ab;GM_xmlhttpRequest({'method':'POST','url':_0x35d78a[_0x1a21b2(0x1e6)],'headers':{'Content-Type':_0x1a21b2(0x1d8)},'data':JSON[_0x1a21b2(0x22e)]({'mode':_0x1a21b2(0x1dd),'emailPrefix':_0x1c9869}),'onload':function(_0x42b7a2){const _0xecb836=_0x1a21b2;try{const _0x46418b=JSON['parse'](_0x42b7a2['responseText']);_0x46418b[_0xecb836(0x23c)]===!![]?(GM_notification({'title':'邮箱准备就绪','text':'邮箱\x20'+_0x1c9869+'\x20已激活','timeout':0x7d0}),_0x25613f('状态',_0xecb836(0x1f7)),_0x455daa(!![])):_0x455daa(![]);}catch(_0x416df7){_0x455daa(![]);}},'onerror':function(_0x3f8f02){_0x455daa(![]);}});});}async function _0x4267ad(_0x584b23){const _0x4f0a39=_0x43cfa1;GM_notification({'title':'正在获取验证码...','text':'来源\x20[TopMediai]','timeout':0x2710}),_0x25613f('状态',_0x4f0a39(0x200));const _0x540922=0xea60,_0x1ab18e=0xbb8,_0x3f2963=Date[_0x4f0a39(0x1f2)](),_0x405862=()=>new Promise(_0x3bee59=>{const _0x367f32=_0x4f0a39;GM_xmlhttpRequest({'method':_0x367f32(0x21d),'url':_0x35d78a[_0x367f32(0x1e6)],'headers':{'Content-Type':_0x367f32(0x1d8)},'data':JSON[_0x367f32(0x22e)]({'mode':_0x367f32(0x1fd),'emailPrefix':_0x584b23,'source':_0x367f32(0x1d9)}),'timeout':0x2710,'onload':_0x3d5166=>{const _0x4a9338=_0x367f32;try{const _0x24886c=JSON[_0x4a9338(0x1db)](_0x3d5166[_0x4a9338(0x230)]);_0x3bee59(_0x24886c[_0x4a9338(0x23c)]&&_0x24886c[_0x4a9338(0x21a)]?_0x24886c[_0x4a9338(0x21a)]:null);}catch(_0x1e459f){_0x3bee59(null);}},'onerror':()=>_0x3bee59(null),'ontimeout':()=>_0x3bee59(null)});});while(Date[_0x4f0a39(0x1f2)]()-_0x3f2963<_0x540922){const _0x16d8a4=document['querySelectorAll'](_0x4f0a39(0x23b));if(_0x16d8a4[_0x4f0a39(0x1ea)]===0x6){const _0x31ec0a=Math[_0x4f0a39(0x1d4)]((_0x540922-(Date[_0x4f0a39(0x1f2)]()-_0x3f2963))/0x3e8);_0x25613f('状态',_0x4f0a39(0x225)+_0x31ec0a+'s)');const _0x20277a=await _0x405862();if(_0x20277a){_0x25613f('状态','成功!\x20正在填充...');for(let _0x55e88d=0x0;_0x55e88d<0x6;_0x55e88d++){_0x1067c9(_0x16d8a4[_0x55e88d],_0x20277a[_0x55e88d]),await _0x1f268f(0x32);}await _0x1f268f(0xc8);const _0x2d6c4b=_0x33cae5([_0x4f0a39(0x20e)]);_0x2d6c4b&&(_0x25613f('状态','提交验证码...'),_0x2d6c4b[_0x4f0a39(0x1f6)]());return;}}await _0x1f268f(_0x1ab18e);}_0x25613f('状态','获取验证码超时!'),GM_notification({'title':_0x4f0a39(0x1dc),'text':'在'+_0x540922/0x3e8+_0x4f0a39(0x22a),'timeout':0x1388});}async function _0x265ce8(_0x54e242){const _0x2722da=_0x43cfa1;_0x25613f('状态',_0x2722da(0x1d7)+_0x54e242);const _0x19e2fa=await _0x1b2550(_0x54e242);if(!_0x19e2fa){_0x25613f('状态',_0x2722da(0x1da)+_0x54e242);return;}const _0x109cca=await _0x92bf65(_0x54e242);if(!_0x109cca){_0x25613f('状态',_0x2722da(0x1f4));return;}_0x25613f('状态','填充表单...');const _0x1af258=await _0x29f9cc(_0x2722da(0x1e2));if(_0x1af258)_0x1067c9(_0x1af258,_0x54e242+_0x35d78a[_0x2722da(0x20d)]);const _0x4fd771=await _0x29f9cc('.Sign-up-box\x20input[placeholder=\x22Password\x22]');if(_0x4fd771)_0x1067c9(_0x4fd771,_0x35d78a[_0x2722da(0x238)]);await _0x1f268f(0xc8);const _0x1c1160=document[_0x2722da(0x22d)](_0x2722da(0x1e4));_0x1c1160&&_0x1c1160[_0x2722da(0x1d3)][_0x2722da(0x222)]()===_0x2722da(0x209)&&(_0x1c1160[_0x2722da(0x1ff)][_0x2722da(0x1f6)](),_0x25613f('状态','已提交注册...'),_0x4267ad(_0x54e242));}async function _0x133ece(){const _0xba3418=_0x43cfa1;_0x25613f('状态',_0xba3418(0x1fe));const _0x3c3f89=await _0x29f9cc(_0xba3418(0x207));if(!_0x3c3f89){const _0x19549f=document[_0xba3418(0x22d)]('.login-block\x20.el-dropdown');if(_0x19549f)_0x19549f[_0xba3418(0x1f6)]();await _0x1f268f(0x1f4);const _0x5bb08b=await _0x29f9cc(_0xba3418(0x207));if(!_0x5bb08b){_0x25613f('状态','无法找到用户菜单');return;}}const _0x13f961=Array[_0xba3418(0x221)](document['querySelectorAll'](_0xba3418(0x1eb)))['find'](_0x57c277=>_0x57c277[_0xba3418(0x1d3)][_0xba3418(0x233)]('@'));if(!_0x13f961){_0x25613f('状态',_0xba3418(0x1ec));return;}const _0x12753d=_0x13f961[_0xba3418(0x1d3)]['trim'](),_0x4d73d9=_0x12753d['split']('@')[0x0];if(document[_0xba3418(0x218)][_0xba3418(0x231)][_0xba3418(0x237)]===_0x4d73d9)return;document[_0xba3418(0x218)]['dataset']['usernameCalculated']=_0x4d73d9;const {base:_0x5c180b,num:_0x49629a}=_0x49b077(_0x4d73d9),_0x1c2a82=''+_0x5c180b+(_0x49629a+0x1);await GM_setValue(_0x567b07(),_0x1c2a82),_0x25613f(_0xba3418(0x1d6),_0x1c2a82),GM_notification({'title':_0xba3418(0x236),'text':_0xba3418(0x226)+_0x1c2a82+_0xba3418(0x22f)});}function _0x146237(){const _0x536d8b=_0x43cfa1,_0x40964f=new MutationObserver(async()=>{const _0xe52997=_0x30a0;if(_0x2c5281)return;_0x2c5281=!![],setTimeout(()=>{_0x2c5281=![];},0x1f4);if(document['querySelector'](_0xe52997(0x242))){_0x25613f('状态',_0xe52997(0x1e7)),_0x133ece();return;}if(document[_0xe52997(0x22d)](_0xe52997(0x239)))return;const _0x497f8a=document[_0xe52997(0x22d)](_0xe52997(0x217));if(!_0x497f8a){const _0x468d0b=_0x33cae5([_0xe52997(0x22c)]);_0x468d0b&&!document[_0xe52997(0x22d)](_0xe52997(0x1ef))&&(_0x25613f('状态',_0xe52997(0x23a)),_0x468d0b[_0xe52997(0x1f6)]());return;}const _0x1b9a1a=_0x497f8a[_0xe52997(0x22d)](_0xe52997(0x216)),_0x2e0b68=_0x497f8a['querySelector'](_0xe52997(0x227));if(_0x1b9a1a&&(!_0x2e0b68||_0x2e0b68[_0xe52997(0x211)][_0xe52997(0x1f9)]===_0xe52997(0x220))){const _0x3fe22c=await _0x29f9cc('.Sign-up-box\x20input[placeholder=\x22Enter\x20registered\x20email\x20account\x22]');if(!_0x3fe22c)return;if(!_0x3fe22c['dataset'][_0xe52997(0x1f3)]){_0x3fe22c[_0xe52997(0x231)][_0xe52997(0x1f3)]=_0xe52997(0x1e5),_0x25613f('状态',_0xe52997(0x214));const _0x3782f1=await GM_getValue(_0x567b07(),null);_0x25613f(_0xe52997(0x1d6),_0x3782f1||'无(等待手动输入)'),_0x3782f1?_0x265ce8(_0x3782f1):(_0x25613f('状态',_0xe52997(0x202)),_0x3fe22c[_0xe52997(0x231)]['waitingForManual']=_0xe52997(0x1e5));}if(_0x3fe22c[_0xe52997(0x231)][_0xe52997(0x1f1)]===_0xe52997(0x1e5)){clearTimeout(_0x5be755);const _0x2d8cca=_0x3fe22c[_0xe52997(0x20c)][_0xe52997(0x222)]();_0x2d8cca!==''&&(_0x5be755=setTimeout(()=>{const _0x4f35e8=_0xe52997;_0x25613f('状态','识别到输入:\x20'+_0x2d8cca);const _0x37b92a=_0x2d8cca[_0x4f35e8(0x1ed)]('@')[0x0];_0x3fe22c[_0x4f35e8(0x231)]['waitingForManual']=_0x4f35e8(0x212),_0x265ce8(_0x37b92a);},0x3e8));}return;}if(_0x2e0b68&&_0x2e0b68[_0xe52997(0x211)][_0xe52997(0x1f9)]!==_0xe52997(0x220)){const _0x4d9d43=_0x2e0b68[_0xe52997(0x22d)](_0xe52997(0x1f0));_0x4d9d43&&_0x4d9d43[_0xe52997(0x1d3)][_0xe52997(0x222)]()===_0xe52997(0x209)&&(!_0x4d9d43['dataset'][_0xe52997(0x235)]&&(_0x25613f('状态',_0xe52997(0x229)),_0x4d9d43[_0xe52997(0x231)][_0xe52997(0x235)]=_0xe52997(0x1e5),_0x4d9d43[_0xe52997(0x1f6)]()));return;}});_0x40964f[_0x536d8b(0x20b)](document['body'],{'childList':!![],'subtree':!![]});}const _0x449d4b=setInterval(()=>{document['body']&&(clearInterval(_0x449d4b),_0x590c72(),_0x146237());},0x64);}()));
